{% extends 'core/base.html' %}

{% block title %}Dashboard{% endblock %}
{% load static %}

{% block contenido %}
    <!-- Begin Page Content -->
    <div class="container-fluid">

        <!-- Page Heading -->
        <div class="d-sm-flex align-items-center justify-content-between mb-4">
            <h1 class="h3 mb-0 text-gray-800">Asset Portfolio</h1>
            <a href="#" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm" onclick="myFunction_print()"><i class="fas fa-download fa-sm text-white-50"></i> Generate Report</a>
            <script>
                function myFunction_print() {
                    window.print();
                }
            </script>
        </div>

        <!-- Top Earning Values -->
        <div class="row">

            <!-- Earnings (Monthly) Card Example -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-success shadow h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-bold text-dark text-uppercase mb-1">Earnings (Monthly)</div>
                                <div class="h5 mb-0 font-weight-bold text-gray-800">$41,033</div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-calendar fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Earnings (Monthly) Card Example -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-success shadow h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-bold text-dark text-uppercase mb-1">Earnings (Annual)</div>
                                <div class="h5 mb-0 font-weight-bold text-gray-800">$215,303</div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-dollar-sign fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Earnings (Monthly) Card Example -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-success shadow h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-bold text-dark text-uppercase mb-1">Earnings (Yesterday)</div>
                                <div class="h5 mb-0 font-weight-bold text-gray-800">$2,671</div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-calendar fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Earnings (Monthly) Card Example -->
            <div class="col-xl-3 col-md-6 mb-4">
                <div class="card border-left-success shadow h-100 py-2">
                    <div class="card-body">
                        <div class="row no-gutters align-items-center">
                            <div class="col mr-2">
                                <div class="text-xs font-weight-bold text-dark text-uppercase mb-1">Total Portfolio</div>
                                <div class="h5 mb-0 font-weight-bold text-gray-800">$40,000</div>
                            </div>
                            <div class="col-auto">
                                <i class="fas fa-calendar fa-2x text-gray-300"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Trading View Candelstick -->
        <div class="row">
            <div class="col-lg-12 mb-4">
                <div class="card shadow mb-4">
                    <div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold text-primary"><i class="fas fa-chart-bar text-primary"></i> Trading View</h6>
                    </div>
                    <div class="card-body">
                        <div class="text-center">
                            <div id="container1">
                                <script>
                                    Highcharts.getJSON('https://cdn.jsdelivr.net/gh/highcharts/highcharts@v7.0.0/samples/data/new-intraday.json', function (data) {
                                        // create the chart
                                        Highcharts.stockChart('container1', {
                                            title: {
                                                text: 'Bitcoin stock price'
                                            },
                                            credits: {
                                                enabled: false
                                            },
                                            rangeSelector: {
                                                buttons: [{
                                                    type: 'hour',
                                                    count: 1,
                                                    text: '1h'
                                                }, {
                                                    type: 'day',
                                                    count: 1,
                                                    text: '1D'
                                                }, {
                                                    type: 'all',
                                                    count: 1,
                                                    text: 'All'
                                                }],
                                                selected: 1,
                                                inputEnabled: false
                                            },

                                            series: [{
                                                name: 'BTCUSD',
                                                type: 'candlestick',
                                                data: data,
                                                tooltip: {
                                                    valueDecimals: 3
                                                }
                                            }]
                                        });
                                    });

                                </script>
                            </div>
                        </div><br><b>
                        <div class="container">
                            <div class="card shopping-cart">
                                <div class="card-body">
                                    <div class="row">
                                        {% block content %}
                                            <form method="post" class="user">
                                                {% csrf_token %}
                                                {{ form }}
                                                <br>
                                                <div class="pull-right">
                                                    <div class="pull-right" style="margin: 5px">
                                                        Fee: <b>{{ fee }}</b>
                                                    </div>
                                                    <div class="pull-right" style="margin: 5px">
                                                        {#                                                        Total price: <b>{{ total }}</b>#}
                                                    </div>
                                                </div>
                                                <button class="btn btn-success pull-right" type="submit" onclick="myFunction()" style="box-shadow: lightgray 2px 2px;"><b>Submit order</b></button>
                                                <script>
                                                    function myFunction() {
                                                        alert("Your order have been places!\n Your order was:" +
                                                                "{{ trx }} \n {{ qty }} at this price {{ asst }} \n Total: {{ total }}");
                                                    }
                                                </script>
                                            </form>
                                        {% endblock %}
                                    </div>
                                </div>
                            </div>
                        </div></b>
                    </div>
                </div>
            </div>
        </div>

        <!-- Earning Charts -->
        <div class="row">

            <!-- Area Chart -->
            <div class="col-xl-8 col-lg-7">
                <div class="card shadow mb-4">
                    <!-- Card Header - Dropdown -->
                    <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                        <h6 class="m-0 font-weight-bold text-primary"><i class="fas fa-chart-line text-primary"></i> Earning Chart</h6>
                        <div class="dropdown no-arrow">
                            <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                            </a>
                            <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in" aria-labelledby="dropdownMenuLink">
                                <div class="dropdown-header">Dropdown Header:</div>
                                <a class="dropdown-item" href="#">Action</a>
                                <a class="dropdown-item" href="#">Another action</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="#">Something else here</a>
                            </div>
                        </div>
                    </div>
                    <!-- Card Body -->
                    <div class="card-body">
                        <div class="chart-area">
                            <canvas id="myAreaChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pie Chart -->
            <div class="col-xl-4 col-lg-5">
                <div class="card shadow mb-4">
                    <!-- Card Header - Dropdown -->
                    <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                        <h6 class="m-0 font-weight-bold text-primary"><i class="fas fa-chart-pie text-primary"></i> Portfolio</h6>
                        <div class="dropdown no-arrow">
                            <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <i class="fas fa-ellipsis-v fa-sm fa-fw text-gray-400"></i>
                            </a>
                            <div class="dropdown-menu dropdown-menu-right shadow animated--fade-in" aria-labelledby="dropdownMenuLink">
                                <div class="dropdown-header">Dropdown Header:</div>
                                <a class="dropdown-item" href="#">Action</a>
                                <a class="dropdown-item" href="#">Another action</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="#">Something else here</a>
                            </div>
                        </div>
                    </div>
                    <!-- Card Body -->
                    <div class="card-body">
                        <div class="chart-pie pt-4 pb-2">
                            <canvas id="myPieChart"></canvas>
                        </div>
                        <div class="mt-4 text-center small">
                    <span class="mr-2">
                      <i class="fas fa-circle text-primary"></i> Bitcoin
                    </span>
                            <span class="mr-2">
                      <i class="fas fa-circle text-success"></i> Gold
                    </span>
                            <span class="mr-2">
                      <i class="fas fa-circle text-info"></i> USD
                    </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <!-- /.container-fluid -->



    <script src="{% static 'core/core/js/highstock.js' %}"></script>
    <script src="{% static 'core/core/js/data.js' %}"></script>
    <script src="{% static 'core/core/js/exporting.js' %}"></script>

{% endblock %}


{#   <!-- Charts Scripts JS-->#}
{#    <script src="https://www.amcharts.com/lib/4/core.js"></script>#}
{#    <script src="https://www.amcharts.com/lib/4/charts.js"></script>#}
{##}
{#    <script>#}
{#                                    am4core.ready(function() {#}
{##}
{#                                        var chart = am4core.create("container1", am4charts.XYChart);#}
{#                                        chart.padding(0, 15, 0, 15);#}
{##}
{#// Load data#}
{#                                        chart.dataSource.url = "{% static 'btcusd.csv' %}";#}
{#                                        chart.dataSource.parser = new am4core.CSVParser();#}
{#                                        chart.dataSource.parser.options.useColumnNames = true;#}
{#                                        chart.dataSource.parser.options.reverse = true;#}
{##}
{#// the following line makes value axes to be arranged vertically.#}
{#                                        chart.leftAxesContainer.layout = "vertical";#}
{##}
{#// uncomment this line if you want to change order of axes#}
{#//chart.bottomAxesContainer.reverseOrder = true;#}
{##}
{#                                        var dateAxis = chart.xAxes.push(new am4charts.DateAxis());#}
{#                                        dateAxis.renderer.grid.template.location = 0;#}
{#                                        dateAxis.renderer.ticks.template.length = 8;#}
{#                                        dateAxis.renderer.ticks.template.strokeOpacity = 0.1;#}
{#                                        dateAxis.renderer.grid.template.disabled = true;#}
{#                                        dateAxis.renderer.ticks.template.disabled = false;#}
{#                                        dateAxis.renderer.ticks.template.strokeOpacity = 0.2;#}
{#                                        dateAxis.renderer.minLabelPosition = 0.01;#}
{#                                        dateAxis.renderer.maxLabelPosition = 0.99;#}
{#                                        dateAxis.keepSelection = true;#}
{#                                        dateAxis.minHeight = 30;#}
{##}
{#                                        dateAxis.groupData = true;#}
{#                                        dateAxis.minZoomCount = 5;#}
{##}
{#// these two lines makes the axis to be initially zoomed-in#}
{#// dateAxis.start = 0.7;#}
{#// dateAxis.keepSelection = true;#}
{##}
{#                                        var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());#}
{#                                        valueAxis.tooltip.disabled = true;#}
{#                                        valueAxis.zIndex = 1;#}
{#                                        valueAxis.renderer.baseGrid.disabled = true;#}
{#// height of axis#}
{#                                        valueAxis.height = am4core.percent(65);#}
{##}
{#                                        valueAxis.renderer.gridContainer.background.fill = am4core.color("#000000");#}
{#                                        valueAxis.renderer.gridContainer.background.fillOpacity = 0.05;#}
{#                                        valueAxis.renderer.inside = true;#}
{#                                        valueAxis.renderer.labels.template.verticalCenter = "bottom";#}
{#                                        valueAxis.renderer.labels.template.padding(2, 2, 2, 2);#}
{##}
{#//valueAxis.renderer.maxLabelPosition = 0.95;#}
{#                                        valueAxis.renderer.fontSize = "0.8em"#}
{##}
{#                                        var series = chart.series.push(new am4charts.CandlestickSeries());#}
{#                                        series.dataFields.dateX = "Date";#}
{#                                        series.dataFields.openValueY = "Open";#}
{#                                        series.dataFields.valueY = "Close";#}
{#                                        series.dataFields.lowValueY = "Low";#}
{#                                        series.dataFields.highValueY = "High";#}
{#                                        series.clustered = false;#}
{#                                        series.tooltipText = "open: {openValueY.value}\nlow: {lowValueY.value}\nhigh: {highValueY.value}\nclose: {valueY.value}";#}
{#                                        series.name = "MSFT";#}
{#                                        series.defaultState.transitionDuration = 0;#}
{##}
{#                                        var valueAxis2 = chart.yAxes.push(new am4charts.ValueAxis());#}
{#                                        valueAxis2.tooltip.disabled = true;#}
{#// height of axis#}
{#                                        valueAxis2.height = am4core.percent(35);#}
{#                                        valueAxis2.zIndex = 3#}
{#// this makes gap between panels#}
{#                                        valueAxis2.marginTop = 30;#}
{#                                        valueAxis2.renderer.baseGrid.disabled = true;#}
{#                                        valueAxis2.renderer.inside = true;#}
{#                                        valueAxis2.renderer.labels.template.verticalCenter = "bottom";#}
{#                                        valueAxis2.renderer.labels.template.padding(2, 2, 2, 2);#}
{#//valueAxis.renderer.maxLabelPosition = 0.95;#}
{#                                        valueAxis2.renderer.fontSize = "0.8em"#}
{##}
{#                                        valueAxis2.renderer.gridContainer.background.fill = am4core.color("#000000");#}
{#                                        valueAxis2.renderer.gridContainer.background.fillOpacity = 0.05;#}
{##}
{#                                        var series2 = chart.series.push(new am4charts.ColumnSeries());#}
{#                                        series2.dataFields.dateX = "Date";#}
{#                                        series2.clustered = false;#}
{#                                        series2.dataFields.valueY = "Volume";#}
{#                                        series2.yAxis = valueAxis2;#}
{#                                        series2.tooltipText = "{valueY.value}";#}
{#                                        series2.name = "Series 2";#}
{#// volume should be summed#}
{#                                        series2.groupFields.valueY = "sum";#}
{#                                        series2.defaultState.transitionDuration = 0;#}
{##}
{#                                        chart.cursor = new am4charts.XYCursor();#}
{##}
{#                                        var scrollbarX = new am4charts.XYChartScrollbar();#}
{##}
{#                                        var sbSeries = chart.series.push(new am4charts.LineSeries());#}
{#                                        sbSeries.dataFields.valueY = "Close";#}
{#                                        sbSeries.dataFields.dateX = "Date";#}
{#                                        scrollbarX.series.push(sbSeries);#}
{#                                        sbSeries.disabled = true;#}
{#                                        scrollbarX.marginBottom = 20;#}
{#                                        chart.scrollbarX = scrollbarX;#}
{#                                        scrollbarX.scrollbarChart.xAxes.getIndex(0).minHeight = undefined;#}
{##}
{##}
{#                                        /**#}
{#                                         * Set up external controls#}
{#                                         */#}
{##}
{#// Date format to be used in input fields#}
{#                                        var inputFieldFormat = "yyyy-MM-dd";#}
{##}
{#                                        document.getElementById("b1m").addEventListener("click", function() {#}
{#                                            resetButtonClass();#}
{#                                            var max = dateAxis.groupMax["day1"];#}
{#                                            var date = new Date(max);#}
{#                                            date.setMonth(date.getMonth() - 1);#}
{##}
{#                                            dateAxis.zoomToDates(#}
{#                                                date,#}
{#                                                new Date(max)#}
{#                                            );#}
{#                                            //this.className = "amcharts-input amcharts-input-selected";#}
{#                                        });#}
{##}
{#                                        document.getElementById("b3m").addEventListener("click", function() {#}
{#                                            resetButtonClass();#}
{#                                            var max = dateAxis.groupMax["day1"];#}
{#                                            var date = new Date(max);#}
{#                                            date.setMonth(date.getMonth() - 3);#}
{##}
{#                                            dateAxis.zoomToDates(#}
{#                                                date,#}
{#                                                new Date(max)#}
{#                                            );#}
{#                                            //this.className = "amcharts-input amcharts-input-selected";#}
{#                                        });#}
{##}
{#                                        document.getElementById("b6m").addEventListener("click", function() {#}
{#                                            resetButtonClass();#}
{#                                            var max = dateAxis.groupMax["day1"];#}
{#                                            var date = new Date(max);#}
{#                                            date.setMonth(date.getMonth() - 6);#}
{##}
{#                                            dateAxis.zoomToDates(#}
{#                                                date,#}
{#                                                new Date(max)#}
{#                                            );#}
{#                                            //this.className = "amcharts-input amcharts-input-selected";#}
{#                                        });#}
{##}
{#                                        document.getElementById("b1y").addEventListener("click", function() {#}
{#                                            resetButtonClass();#}
{#                                            var max = dateAxis.groupMax["week1"];#}
{#                                            var date = new Date(max);#}
{#                                            date.setFullYear(date.getFullYear() - 1);#}
{##}
{#                                            dateAxis.zoomToDates(#}
{#                                                date,#}
{#                                                new Date(max)#}
{#                                            );#}
{#                                            //this.className = "amcharts-input amcharts-input-selected";#}
{#                                        });#}
{##}
{#                                        document.getElementById("bytd").addEventListener("click", function() {#}
{#                                            resetButtonClass();#}
{#                                            var date = new Date(dateAxis.max);#}
{#                                            date.setMonth(0, 1);#}
{#                                            date.setHours(0, 0, 0, 0);#}
{#                                            dateAxis.zoomToDates(date, new Date(dateAxis.max));#}
{#                                            //this.className = "amcharts-input amcharts-input-selected";#}
{#                                        });#}
{##}
{#                                        document.getElementById("bmax").addEventListener("click", function() {#}
{#                                            resetButtonClass();#}
{#                                            dateAxis.zoom({start:0, end:1});#}
{#                                            //this.className = "amcharts-input amcharts-input-selected";#}
{#                                        });#}
{##}
{#                                        function resetButtonClass() {#}
{#                                            var selected = document.getElementsByClassName("amcharts-input-selected");#}
{#                                            for(var i = 0; i < selected.length; i++) {#}
{#                                                selected[i].className = "amcharts-input";#}
{#                                            }#}
{#                                        }#}
{##}
{#                                        dateAxis.events.on("selectionextremeschanged", function() {#}
{#                                            updateFields();#}
{#                                        });#}
{##}
{#                                        dateAxis.events.on("extremeschanged", updateFields);#}
{##}
{#                                        function updateFields() {#}
{#                                            var minZoomed = dateAxis.minZoomed + am4core.time.getDuration(dateAxis.mainBaseInterval.timeUnit, dateAxis.mainBaseInterval.count) * 0.5;#}
{#                                            document.getElementById("fromfield").value = chart.dateFormatter.format(minZoomed, inputFieldFormat);#}
{#                                            document.getElementById("tofield").value = chart.dateFormatter.format(new Date(dateAxis.maxZoomed), inputFieldFormat);#}
{#                                        }#}
{##}
{#                                        document.getElementById("fromfield").addEventListener("keyup", updateZoom);#}
{#                                        document.getElementById("tofield").addEventListener("keyup", updateZoom);#}
{##}
{#                                        var zoomTimeout;#}
{#                                        function updateZoom() {#}
{#                                            if (zoomTimeout) {#}
{#                                                clearTimeout(zoomTimeout);#}
{#                                            }#}
{#                                            zoomTimeout = setTimeout(function() {#}
{#                                                resetButtonClass();#}
{#                                                var start = document.getElementById("fromfield").value;#}
{#                                                var end = document.getElementById("tofield").value;#}
{#                                                if ((start.length < inputFieldFormat.length) || (end.length < inputFieldFormat.length)) {#}
{#                                                    return;#}
{#                                                }#}
{#                                                var startDate = chart.dateFormatter.parse(start, inputFieldFormat);#}
{#                                                var endDate = chart.dateFormatter.parse(end, inputFieldFormat);#}
{##}
{#                                                if (startDate && endDate) {#}
{#                                                    dateAxis.zoomToDates(startDate, endDate);#}
{#                                                }#}
{#                                            }, 500);#}
{#                                        }#}
{##}
{#                                    }); // end am4core.ready()#}
{#                                </script>#}